---
title: "エラー 0x80070002: 要求されたファイルが見つかりません"
errorText: "エラー 0x80070002: 要求されたファイルが見つかりません"
tags: ["Windows", "Update"]
updatedAt: "2025-11-03T09:11:56.107Z"
lang: "en"
---

## Summary
- Trigger (1 line)
  - "Error 0x80070002: The system cannot find the file specified" occurs when an installer, update, or file operation references a file that is missing or inaccessible.
- Impact (1 line)
  - Causes installation/update failures, app launch errors, or script termination.
- Severity (Medium, 1-line reason)
  - Medium: stops user tasks but is typically resolvable by correcting path, permissions, locks, or security settings.

## Common causes (priority order)
1. Incorrect path or filename (typo, missing extension)
2. Access denied due to ownership/ACL
3. Blocked by Zone.Identifier/MOTW after download or extraction
4. File locked by another process (antivirus, sync client, other user)
5. Execution control (AppLocker / SRP / SmartScreen) blocking the file

## 60-second checks (quickest steps)
- Run as administrator and retry
- Check current ACL:
  ```cmd
  icacls "C:\Path\To\Folder"
  ```
- Verify your privileges:
  ```cmd
  whoami /groups & whoami /priv
  ```
- Check Defender detections and Controlled Folder Access state:
  ```powershell
  Get-MpThreatDetection -ErrorAction SilentlyContinue | Select Timestamp, Action, Resources | Select -First 5
  Get-MpPreference | Select EnableControlledFolderAccess
  ```
- Check TEMP folder permissions:
  ```cmd
  echo %TEMP%
  icacls "%TEMP%"
  ```
- Snapshot GPO effects:
  ```cmd
  gpresult /h "%USERPROFILE%\Desktop\gp.html"
  ```

## 5-minute fix (practical flow)
1) Identify target → assign ownership/permissions (GUI or command)
2) Register app in Controlled Folder Access/EDR or remove MOTW
   - PowerShell (unblock):
     ```powershell
     Unblock-File -Path "C:\Path\to\installer-or-script.exe"
     ```
   - GUI: Properties → check "Unblock" and retry
3) If locked, reboot, boot Safe Mode, or safely stop the holding process (use resmon to find handles)

## Long-term mitigations
- Correct ownership and inheritance (limit scope)
- Maintain Defender/EDR allowlists and exception policies
- Define GPO/EDR approval and distribution workflows
- Avoid running installers directly from network shares or ZIPs; copy to local (e.g., C:\Temp) before execution

## Detailed steps (Windows 10/11)
1. GUI change: Right-click target folder → Properties → Security → Advanced → change Owner → enable/disable inheritance as needed.
2. Command examples (run as admin)
   ```cmd
   takeown /F "C:\Path\To\Folder" /R /D Y
   icacls "C:\Path\To\Folder" /grant Administrators:F /T
   ```
   Rollback example (restore to SYSTEM):
   ```powershell
   $p = "C:\Path\To\Folder"
   icacls $p /setowner "NT AUTHORITY\SYSTEM" /T
   ```
   Restore excessive permissions to defaults (inheritance / ACL repair):
   ```cmd
   icacls "C:\Path\To\Folder" /inheritance:e
   icacls "C:\Path\To\Folder" /reset
   ```
3. Defender: check and add allowed application
   - Check state:
     ```powershell
     Get-MpPreference | Select EnableControlledFolderAccess, ControlledFolderAccessAllowedApplications
     ```
   - Add allowed app:
     ```powershell
     Add-MpPreference -ControlledFolderAccessAllowedApplications "C:\Path\app.exe"
     ```
4. If the file is locked (how to find)
   - Run resmon (Win+R → resmon) → CPU tab → Associated Handles → search path → terminate process or reboot/Safe Mode.

⚠ Note: If you temporarily disable antivirus or CFA to perform work, disable only during the task and re-enable immediately after (rollback: re-enable Defender/CFA and revert policy changes).

## Common mistakes (do not)
- Changing ownership broadly under Windows/Program Files/System32
- Granting Everyone:Full on shared folders
- Permanently disabling antivirus without proper approvals

## Recurrence checklist
- Enforce standard-user operation and elevate only when necessary
- Execute installers immediately after download and verify zone information
- Document and peer-review permission or policy changes

## Related cases
- Steps for 0x80070005 during Windows Update
- Steps for 0x80070005 during Office/Outlook activation
- Steps for 0x80070005 with OneDrive/sync clients

## References
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/icacls
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/takeown
- https://learn.microsoft.com/en-us/powershell/module/defender/get-mppreference
- https://learn.microsoft.com/en-us/powershell/module/defender/add-mppreference
- https://learn.microsoft.com/en-us/defender-endpoint/enable-controlled-folders
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/gpresult