---
title: ".NET Framework 3.5 のインストールに失敗 0x800F081F"
errorText: ".NET Framework 3.5 のインストールに失敗 0x800F081F"
tags: ["Windows", ".NET", "DISM"]
updatedAt: "2025-11-03T09:11:56.107Z"
lang: "en"
---

## Summary
- Trigger (1 line)  
  Error 0x800F081F occurs when enabling .NET Framework 3.5 and required SxS source files are missing or blocked by OS policies.  
- Impact (1 line)  
  Applications depending on .NET 3.5 will fail to install or run.  
- Urgency (Medium, 1-line reason)  
  Medium — impact depends on app dependency, but root causes can be diagnosed and often fixed quickly with commands.

## Common causes (priority order)
1. Installation source (Windows Update or local sources\sxs) unavailable or mismatched.  
2. WSUS/GPO restricting feature downloads (needs /LimitAccess handling).  
3. Corrupted component store (requires DISM/SFC repair).  
4. File or folder permissions or file locks preventing reading SxS files.  
5. Blocking by AppLocker / SRP / SmartScreen or other execution controls.

## 60-second checks (quickest steps)
- Start elevated PowerShell/CMD → retry install.  
- Check current ACL:
```cmd
icacls "C:\Windows\winsxs"
```
- Check your privileges:
```cmd
whoami /groups & whoami /priv
```
- Check Defender blocks/history and CFA state:
```powershell
Get-MpThreatDetection -ErrorAction SilentlyContinue | Select Timestamp, Action, Resources | Select -First 5
Get-MpPreference | Select EnableControlledFolderAccess
```
- Verify TEMP folder permissions:
```cmd
echo %TEMP%
icacls "%TEMP%"
```
- Snapshot GPO impact:
```cmd
gpresult /h "%USERPROFILE%\Desktop\gp.html"
```

## 5-minute remediation (practical flow)
1) Verify and specify installation source  
   - Prepare sources\sxs from ISO/install media and run:
```cmd
dism /online /enable-feature /featurename:NetFx3 /All /Source:D:\sources\sxs /LimitAccess
```
2) Repair component store if suspected:
```cmd
dism /online /cleanup-image /restorehealth
sfc /scannow
```
3) If ownership/permissions block access, grant ownership/permissions:
```cmd
takeown /F "C:\Windows\winsxs" /R /D Y
icacls "C:\Windows\winsxs" /grant Administrators:F /T
```
   ⚠ Note: Broad ownership/ACL changes can destabilize the system. Roll back after work (see rollback examples).  
4) If Controlled Folder Access or EDR blocks the installer, add a temporary allow or disable only during work, then run the installer.  
   - Unblock Zone info:
```powershell
Unblock-File -Path "C:\Path\to\installer-or-script.exe"
```
   ⚠ Note: Temporary disablement should be for the duration of the task only. Re-enable afterward (rollback: restore original settings).

## Long-term fixes (permanent)
- Standardize procedure to provide sources\sxs when installing .NET 3.5.  
- Maintain Defender/EDR allow lists for approved installers.  
- Implement request/approval flow for GPO/EDR exceptions.  
- Avoid running installers directly from network/ZIP; always copy locally (e.g., C:\Temp) before execution.

## Detailed steps (Windows 10/11)
1. Use GUI to inspect owner and inheritance for target folders (C:\Windows\winsxs or the source folder).  
2. Example commands (run elevated):
```cmd
takeown /F "C:\Windows\winsxs" /R /D Y
icacls "C:\Windows\winsxs" /grant Administrators:F /T
```
   Rollback example (restore SYSTEM owner):
```powershell
$p = "C:\Windows\winsxs"
icacls $p /setowner "NT AUTHORITY\SYSTEM" /T
```
   Restore excessive permissions to defaults (inheritance/ACL repair):
```cmd
icacls "C:\Windows\winsxs" /inheritance:e
icacls "C:\Windows\winsxs" /reset
```
3. Defender: check state and add allowed application
```powershell
Get-MpPreference | Select EnableControlledFolderAccess, ControlledFolderAccessAllowedApplications
Add-MpPreference -ControlledFolderAccessAllowedApplications "C:\Path\to\dism.exe"
```
   Rollback: Remove the allowed entry or restore policy-managed settings.  
4. If a file is locked (how to find)  
   - Run resmon (Win + R → resmon) → CPU tab → Associated Handles → search path → terminate process or reboot / use safe mode.  
   ⚠ Note: Forcibly terminating processes can stop services or cause data loss. Rollback: reboot to restore services.

## Common mistakes (do not)
- Assigning broad Everyone:Full on Windows folders (winsxs etc.).  
- Permanently disabling Defender/EDR without documented mitigation.

## Recurrence checklist
- Operate as standard user and elevate only when needed.  
- Run installers immediately after download; avoid executing directly from archives or network shares.  
- Document and review permission changes.

## Related cases
- When Windows Update shows 0x80070005, follow related remediation.  
- When Office/Outlook activation reports 0x80070005.  
- When OneDrive/sync clients report 0x80070005.

## References
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/icacls  
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/takeown  
- https://learn.microsoft.com/en-us/powershell/module/defender/get-mppreference  
- https://learn.microsoft.com/en-us/powershell/module/defender/add-mppreference  
- https://learn.microsoft.com/en-us/defender-endpoint/enable-controlled-folders  
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/gpresult