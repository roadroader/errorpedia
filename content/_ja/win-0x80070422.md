---
title: "Windows Update サービスが無効です 0x80070422"
errorText: "Windows Update サービスが無効です 0x80070422"
tags: ["Windows", "Update", "Service"]
updatedAt: "2025-11-03T09:11:56.107Z"
lang: "ja"
---

## 要約
- 発生条件（1行）  
  Windows Update を実行した際に「Windows Update サービスが無効です 0x80070422」が表示され、サービスが停止または無効化されているときに発生します。  
- 影響（1行）  
  Windows Update の確認・ダウンロード・適用ができず、セキュリティパッチが適用されません。  
- 緊急度（高/中/低、理由1行）  
  高（セキュリティ更新の未適用によりリスクが即時発生するため）。

## よくある原因（優先度順）
1. Windows Update サービス（wuauserv）が無効または停止している。  
2. 依存サービス（Background Intelligent Transfer Service, CryptSvc 等）が停止または壊れている。  
3. サービス関連のレジストリ/ACL が不正に変更され、サービス起動が遮断されている。  
4. ファイル/ハンドルロックによりサービスが必要なファイルにアクセスできない（ファイルロックが原因）。  
5. AppLocker / ソフトウェア制限ポリシー(SRP) / SmartScreen などの実行制御によるブロック。

## 60秒で確認（最短手順）
- 管理者でコマンドプロンプト/PowerShell を起動してから再試行する。  
- 現在のACLを確認：
```cmd
icacls "C:\Windows\System32\wuauserv"
```
- 自分の特権を確認：
```cmd
whoami /groups & whoami /priv
```
- Defenderのブロック/履歴とCFA有効状態を確認：
```powershell
Get-MpThreatDetection -ErrorAction SilentlyContinue | Select Timestamp, Action, Resources | Select -First 5
Get-MpPreference | Select EnableControlledFolderAccess
```
- TEMPフォルダーの権限を確認：
```cmd
echo %TEMP%
icacls "%TEMP%"
```
- GPOの影響をスナップショット：
```cmd
gpresult /h "%USERPROFILE%\Desktop\gp.html"
```

## 5分で解決（実務フロー）
1) 対象を特定 → サービス状態を確認し、wuauserv と依存サービスを開始：
```cmd
sc query wuauserv
sc start wuauserv
sc start bits
sc start cryptsvc
```
2) 所有権/権限に問題があれば付与（GUIまたは下記コマンド）  
3) 制御されたフォルダーアクセスやEDRでブロックされていれば許可登録、MOTW(Zone.Identifier)解除を実施  
   - PowerShell（ブロック解除）:
```powershell
Unblock-File -Path "C:\Path\to\installer-or-script.exe"
```
   - GUI: 該当ファイルのプロパティ → 「ブロックの解除」にチェック  
4) ファイルロックが疑われる場合はプロセスを停止または再起動／セーフモードで作業。  
5) 再起動後に Windows Update の動作確認。

## 根本対策（恒久策）
- サービスのACL/所有権を局所的に是正し、広範な権限変更は避ける。  
- Defender/EDR の許可アプリと例外ポリシーを整備する。  
- GPO/EDR 変更は申請ワークフローを作り記録する。  
- インストーラーや実行ファイルは共有やZIP直下で実行せず、ローカル（例: C:\Temp）にコピーして実行する。

## 詳細手順（Windows 10/11）
1. GUIでの設定変更（ファイル/フォルダーの所有者を適切なアカウントに戻し、継承を有効化して必要最小の権限を与える）。  
2. コマンド例（管理者で実行）
```cmd
takeown /F "C:\Path\To\Folder" /R /D Y
icacls "C:\Path\To\Folder" /grant Administrators:F /T
```
**ロールバック例**（SYSTEMに戻す）:
```powershell
$p = "C:\Path\To\Folder"
icacls $p /setowner "NT AUTHORITY\SYSTEM" /T
```
**付け過ぎた権限を既定に戻す（継承/ACLの修復）**:
```cmd
icacls "C:\Path\To\Folder" /inheritance:e
icacls "C:\Path\To\Folder" /reset
```
3. Defender: 状態確認と許可アプリ
```powershell
Get-MpPreference | Select EnableControlledFolderAccess, ControlledFolderAccessAllowedApplications
Add-MpPreference -ControlledFolderAccessAllowedApplications "C:\Path\app.exe"
```
4. ファイルがロック中なら（見つけ方）  
- Win + R → resmon → CPU タブ → 「関連付けられたハンドル」でパスを検索 → 該当プロセスを終了、または再起動／セーフモードで作業。

⚠ 注意: Defender/EDR の一時無効化や広範な権限付与は作業中のみ実施し、作業完了後は必ず元に戻す（ロールバック：同じコマンドで元の所有者/ACL を再設定）。

## よくある落とし穴（やってはいけない）
- Windows\System32 や Program Files に対する広範な所有権変更を行う。  
- 共有フォルダーに Everyone:Full の権限を付与する。

## 再発防止チェックリスト
- 標準ユーザー運用を徹底し、必要時のみ昇格する。  
- インストーラーはダウンロード直後にローカルへコピーして実行する。  
- 変更手順を文書化してレビューを義務付ける。

## 関連ケース
- Windows Update で 0x80070005 が出るときの手順  
- Office/Outlook の有効化で 0x80070005 が出るとき  
- OneDrive/同期クライアントで 0x80070005 が出るとき

## 参考（一次情報）
- https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/icacls  
- https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/takeown  
- https://learn.microsoft.com/ja-jp/powershell/module/defender/get-mppreference  
- https://learn.microsoft.com/ja-jp/powershell/module/defender/add-mppreference  
- https://learn.microsoft.com/ja-jp/defender-endpoint/enable-controlled-folders  
- https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/gpresult