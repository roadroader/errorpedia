---
title: "Office の更新に失敗 0x80070005"
errorText: "Office の更新に失敗 0x80070005"
tags: ["Office", "Update", "Permission"]
updatedAt: "2025-11-03T09:11:56.107Z"
lang: "en"
---

## Summary
- Trigger (1 line)  
  Office update fails during install/update with access denied and error code 0x80070005.  
- Impact (1 line)  
  Office updates are blocked, leaving security fixes and feature updates unapplied.  
- Urgency (High/Medium/Low, 1-line reason)  
  Medium. Blocks user workflows and may leave security vulnerabilities, so privileges must be checked promptly.

## Common causes (by priority)
1. Insufficient permissions (installer cannot write or execute in target folder)  
2. Ownership held by another account (SYSTEM/other user prevents access)  
3. Security product (Defender/EDR/Controlled Folder Access) blocking files or processes  
4. File lock (another process has the installer or temp file open)  
5. AppLocker / Software Restriction Policies (SRP) / SmartScreen blocking execution

## 60-second check
- Launch as administrator → retry update  
- Check current ACLs:
  ```cmd
  icacls "C:\Path\To\Folder"
  ```
- Check your privileges:
  ```cmd
  whoami /groups & whoami /priv
  ```
- Check Defender block/history and CFA state:
  ```powershell
  Get-MpThreatDetection -ErrorAction SilentlyContinue | Select Timestamp, Action, Resources | Select -First 5
  Get-MpPreference | Select EnableControlledFolderAccess
  ```
- Check TEMP folder permissions:
  ```cmd
  echo %TEMP%
  icacls "%TEMP%"
  ```
- Snapshot GPO impact:
  ```cmd
  gpresult /h "%USERPROFILE%\Desktop\gp.html"
  ```

## 5-minute fix (operational flow)
1) Identify target → grant ownership/permissions (GUI or commands)  
2) Register installer in Controlled Folder Access or EDR allowlist, remove MOTW (Zone.Identifier)  
   - PowerShell (unblock):
     ```powershell
     Unblock-File -Path "C:\Path\to\installer-or-script.exe"
     ```
   - GUI: Check "Unblock" in file Properties  
3) If locked, reboot / boot to Safe Mode / safely terminate the holding process

## Permanent fixes
- Correct ownership and inheritance locally (avoid broad changes to system folders)  
- Harden Defender/EDR allowlist policies to include legitimate installers  
- Operationalize exception request flows under GPO/EDR management  
- Avoid running installers from shares or ZIPs; copy to local (e.g., C:\Temp) then run

## Detailed steps (Windows 10/11)
1. GUI adjustments (Properties → Security → Advanced → Change owner → enable inheritance → assign required permissions)  
2. Command examples (run as administrator)
   ```cmd
   takeown /F "C:\Path\To\Folder" /R /D Y
   icacls "C:\Path\To\Folder" /grant Administrators:F /T
   ```
   Rollback example (restore to SYSTEM):
   ```powershell
   $p = "C:\Path\To\Folder"
   icacls $p /setowner "NT AUTHORITY\SYSTEM" /T
   ```
   Restore excessive permissions / repair inheritance:
   ```cmd
   icacls "C:\Path\To\Folder" /inheritance:e
   icacls "C:\Path\To\Folder" /reset
   ```
3. Defender: check settings and add allowed app  
   - Check state:
     ```powershell
     Get-MpPreference | Select EnableControlledFolderAccess, ControlledFolderAccessAllowedApplications
     ```
   - Add allow:
     ```powershell
     Add-MpPreference -ControlledFolderAccessAllowedApplications "C:\Path\app.exe"
     ```
4. If a file is locked (how to find)  
   - Win + R → resmon → CPU → Associated Handles → search path → terminate process or reboot/perform work in Safe Mode.  
⚠ Note: Temporarily disabling security products or granting broad permissions must be limited to the task. Rollback: re-enable protection and restore original ACL/ownership after completion.

## Common pitfalls (do not)
- Change ownership broadly under Windows/Program Files/System32  
- Grant Everyone:Full on shared folders

## Prevention checklist
- Enforce standard user operation with elevation only when needed  
- Run installers immediately after download from a local copy  
- Document and review change procedures and exception requests

## Related cases
- Procedures when 0x80070005 occurs during Windows Update  
- Procedures when 0x80070005 occurs during Office/Outlook activation  
- Procedures when 0x80070005 occurs with OneDrive/sync clients

## References (primary sources)
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/icacls  
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/takeown  
- https://learn.microsoft.com/en-us/powershell/module/defender/get-mppreference  
- https://learn.microsoft.com/en-us/powershell/module/defender/add-mppreference  
- https://learn.microsoft.com/en-us/defender-endpoint/enable-controlled-folders  
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/gpresult