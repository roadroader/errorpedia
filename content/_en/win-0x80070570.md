---
title: "ファイルが破損しているため Windows をインストールできません 0x80070570"
errorText: "ファイルが破損しているため Windows をインストールできません 0x80070570"
tags: ["Windows", "Setup", "Storage"]
updatedAt: "2025-11-03T09:11:56.107Z"
lang: "en"
---

## Summary
- Trigger (1 line)
  - Error 0x80070570 occurs when the Windows installer cannot read installation files or hash verification fails.
- Impact (1 line)
  - Installation/upgrade halts; causes include installer media corruption, access-rights issues, or file locks.
- Severity (High/Medium/Low, 1-line reason)
  - High: OS installation failure can cause service interruption and require re-imaging.

## Common causes (priority order)
1. Corrupt or incomplete installation media (ISO/USB)
2. Partial download corruption or Zone.Identifier (MOTW) blocking
3. Local/target folder permission or ownership mismatch
4. File locked by a process (antivirus, indexer, another user)
5. Execution control blocks (AppLocker / SRP / SmartScreen)

## 60-second checks (quick commands)
- Launch as administrator → retry
- Check current ACL:
  ```cmd
  icacls "C:\Path\To\Folder"
  ```
- Check your privileges:
  ```cmd
  whoami /groups & whoami /priv
  ```
- Check Defender detections and CFA state:
  ```powershell
  Get-MpThreatDetection -ErrorAction SilentlyContinue | Select Timestamp, Action, Resources | Select -First 5
  Get-MpPreference | Select EnableControlledFolderAccess
  ```
- Verify TEMP folder permissions:
  ```cmd
  echo %TEMP%
  icacls "%TEMP%"
  ```
- Snapshot GPO effects:
  ```cmd
  gpresult /h "%USERPROFILE%\Desktop\gp.html"
  ```

## 5-minute resolution (practical flow)
1) Identify the target → grant ownership/permissions (GUI or commands)
2) Whitelist in Controlled Folder Access / EDR; unblock MOTW
   - PowerShell (remove block):
     ```powershell
     Unblock-File -Path "C:\Path\to\installer-or-script.exe"
     ```
   - GUI: Properties → Check "Unblock"
3) If locked, reboot / boot Safe Mode / safely terminate holding process

## Permanent mitigations
- Correct ownership and inheritance locally only
- Maintain Defender/EDR allowlists and exception policies
- Establish approval flows for GPO/EDR-managed systems
- Avoid running installers directly from shares or ZIPs; copy to local (e.g., C:\Temp) first

## Detailed steps (Windows 10/11)
1. GUI: verify folder owner → enable inheritance → assign least required permissions
2. Command examples (run as admin)
   ```cmd
   takeown /F "C:\Path\To\Folder" /R /D Y
   icacls "C:\Path\To\Folder" /grant Administrators:F /T
   ```
   Rollback example (restore to SYSTEM):
   ```powershell
   $p = "C:\Path\To\Folder"
   icacls $p /setowner "NT AUTHORITY\SYSTEM" /T
   ```
   Restore excessive permissions / repair inheritance:
   ```cmd
   icacls "C:\Path\To\Folder" /inheritance:e
   icacls "C:\Path\To\Folder" /reset
   ```
3. Defender: check and add allowed applications
   - Check state:
     ```powershell
     Get-MpPreference | Select EnableControlledFolderAccess, ControlledFolderAccessAllowedApplications
     ```
   - Add allow entry:
     ```powershell
     Add-MpPreference -ControlledFolderAccessAllowedApplications "C:\Path\app.exe"
     ```
4. If a file is locked (how to find)
   - Win + R → resmon → CPU tab → search "Associated Handles" for the path → terminate process or reboot/boot Safe Mode.

⚠ Note: Broad ownership/ACL changes can break the system. Take backups before changes and always restore ownership/ACLs after work. Rollback: run the "Rollback example" above to return ownership.

## Common pitfalls (do not do)
- Change ownership broadly on Windows/Program Files/System32 root
- Grant Everyone:Full on shared folders
- Permanently disable EDR to bypass blocks

## Recurrence checklist
- Operate as standard user; elevate only when required
- Copy installers to local storage immediately after download before running
- Document and peer-review change procedures

## Related cases
- Steps when 0x80070005 appears during Windows Update
- Steps when 0x80070005 appears during Office/Outlook activation
- Steps when 0x80070005 appears with OneDrive/sync clients

## References
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/icacls
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/takeown
- https://learn.microsoft.com/en-us/powershell/module/defender/get-mppreference
- https://learn.microsoft.com/en-us/powershell/module/defender/add-mppreference
- https://learn.microsoft.com/en-us/defender-endpoint/enable-controlled-folders
- https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/gpresult