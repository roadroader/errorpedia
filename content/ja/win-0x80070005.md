---
title: "エラー 0x80070005: アクセスが拒否されました"
errorText: "エラー 0x80070005: アクセスが拒否されました"
tags: ["Windows", "Permission", "Update"]
updatedAt: "2025-11-03T09:11:56.107Z"
lang: "ja"
---

## 要約
- 発生条件（1行）: ファイル/フォルダー操作やインストール時にWindowsが0x80070005（アクセス拒否）で処理を拒否する。
- 影響（1行）: インストール失敗、設定反映不能、アプリ実行や更新の停止。
- 緊急度（中、理由）: 中 — 作業者権限やセキュリティ制御で即時業務停止になるが、手順で短時間復旧可能。

## よくある原因（優先度順）
1. 所有権が異なり現在のアカウントに必要なACLが付与されていない。
2. Defender/EDRの制御されたフォルダーアクセス(CFA)やアンチウイルスがブロックしている。
3. グループポリシーやサービスの特権不足で権限が奪われている。
4. ファイルが別プロセスによりロックされている（インストーラー/同期クライアントによるハンドル保持）。
5. AppLocker / ソフトウェア制限ポリシー(SRP) / SmartScreen などの実行制御によるブロック。

## 60秒で確認（最短手順）
- 管理者で起動 → 再試行
- 現在のACLを確認：
```cmd
icacls "C:\Path\To\Folder"
```
- 自分の特権を確認：
```cmd
whoami /groups & whoami /priv
```
- Defenderのブロック/履歴とCFA有効状態を確認：
```powershell
Get-MpThreatDetection -ErrorAction SilentlyContinue | Select Timestamp, Action, Resources | Select -First 5
Get-MpPreference | Select EnableControlledFolderAccess
```
- TEMPフォルダーの権限を確認：
```cmd
echo %TEMP%
icacls "%TEMP%"
```
- GPOの影響をスナップショット：
```cmd
gpresult /h "%USERPROFILE%\Desktop\gp.html"
```

## 5分で解決（実務フロー）
1) 対象を特定 → 所有権/権限を付与（GUIまたは以下コマンド）。
2) 制御されたフォルダーアクセスやEDRの許可登録、MOTW(Zone.Identifier)の解除を実施。
   - PowerShell（ブロック解除）:
```powershell
Unblock-File -Path "C:\Path\to\installer-or-script.exe"
```
   - GUI: 対象ファイルの「プロパティ → ブロックの解除」にチェックして適用。
3) ロック中ならリブート/セーフモード/保持プロセスの安全な終了を実施。

## 根本対策（恒久策）
- 所有権と継承の是正を局所的に行い、広範囲なSYSTEM/Administrators付与を避ける。
- Defender/EDRで正当なインストーラーや管理ツールを許可アプリとして登録する。
- GPOやEDR配下の権限申請フローを整備し、対処ログを残す。
- 共有やZIP直からの実行を避け、ローカル（例: C:\Temp）にコピーしてから実行する習慣を徹底する。

## 詳細手順（Windows 10/11）
1. GUIでの設定変更
   - フォルダー右クリック→「プロパティ→セキュリティ→詳細設定」から所有者を変更し、継承設定を確認。
2. コマンド例（管理者で実行）
```cmd
takeown /F "C:\Path\To\Folder" /R /D Y
icacls "C:\Path\To\Folder" /grant Administrators:F /T
```
   ロールバック例（SYSTEMに戻す）:
```powershell
$p = "C:\Path\To\Folder"
icacls $p /setowner "NT AUTHORITY\SYSTEM" /T
```
   付け過ぎた権限を既定に戻す（継承/ACLの修復）:
```cmd
icacls "C:\Path\To\Folder" /inheritance:e
icacls "C:\Path\To\Folder" /reset
```
3. Defender: 設定と許可アプリ
   - 状態確認:
```powershell
Get-MpPreference | Select EnableControlledFolderAccess, ControlledFolderAccessAllowedApplications
```
   - 許可追加:
```powershell
Add-MpPreference -ControlledFolderAccessAllowedApplications "C:\Path\app.exe"
```
4. ファイルがロック中なら（見つけ方）
   - Win + R → resmon → CPU タブ → 関連付けられたハンドルでパスを検索 → 該当プロセスを終了、または再起動／セーフモードで処理。
⚠ 注意: 一時的にアンチウイルス/EDRを無効化する場合は作業時間を短くし、必ず作業後に再有効化する。ロールバック: 設定画面から元に戻すか、サービスを再起動して有効化。

## よくある落とし穴（やってはいけない）
- Windows/Program Files/System32 直下への広範な所有権変更を行う。
- 共有フォルダーに Everyone:フル を付与してしまう。

## 再発防止チェックリスト
- 標準ユーザー運用＋必要時のみ昇格を運用に組み込む。
- インストーラーはダウンロード直後に実行してロック発生を避ける。
- 変更手順の文書化と事前レビューを必須にする。

## 関連ケース
- Windows Update で 0x80070005 が出るときの手順
- Office/Outlook の有効化で 0x80070005 が出るとき
- OneDrive/同期クライアントで 0x80070005 が出るとき

## 参考（一次情報）
- https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/icacls
- https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/takeown
- https://learn.microsoft.com/ja-jp/powershell/module/defender/get-mppreference
- https://learn.microsoft.com/ja-jp/powershell/module/defender/add-mppreference
- https://learn.microsoft.com/ja-jp/defender-endpoint/enable-controlled-folders
- https://learn.microsoft.com/ja-jp/windows-server/administration/windows-commands/gpresult